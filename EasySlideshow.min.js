/*
 Copyright (c) 2017 Maxwell Dreytser

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

*/
window.EasySlideshowJS=function(d,a,C,k,x){function m(e,p,g,b,f){window.jQuery?window.Velocity?$(e).velocity({opacity:p},{duration:g,complete:function(){b&&b()},progress:function(b,e,g,p,k){f&&q.forEach(function(b){setTimeout(function(){b(d,a,a[c],c,e)},0)})}}):window.TweenLite||window.TweenMax?(TweenLite||TweenMax).to(e,g,{opacity:p,onComplete:function(){b&&b()},onUpdate:function(b){f&&q.forEach(function(e){setTimeout(function(){e(d,a,a[c],c,b.progress())},0)})},onStartParams:["{self}"]}):$(e).animate({opacity:p},
{duration:g,complete:function(){b&&b()},progress:function(b,e,g){f&&q.forEach(function(b){setTimeout(function(){b(d,a,a[c],c,e())},0)})}}):window.Velocity?Velocity(e,{opacity:p},{duration:g,complete:function(){b&&b()},progress:function(b,e,g,p,k){f&&q.forEach(function(b){setTimeout(function(){b(d,a,a[c],c,e)},0)})}}):window.TweenLite||window.TweenMax?(TweenLite||TweenMax).to(e,g,{opacity:p,onComplete:function(){b&&b()},onUpdate:function(b){f&&q.forEach(function(e){setTimeout(function(){e(d,a,a[c],
c,b.progress())},0)})},onStartParams:["{self}"]}):(f&&q.forEach(function(b){setTimeout(function(){b(d,a,a[c],c,0)},0)}),e.style.opacity=p,f&&q.forEach(function(b){setTimeout(function(){b(d,a,a[c],c,1)},0)}),b&&b())}function y(a,c){for(var e=0;e<a.length;)a[e]==c?a.splice(e,1):e++}function w(){function e(){t&&(d.ShowNextImg=function(){console.log("Race condition in ShowNextImg (EasySlideshowJS)!")},f.loaded?(u=!0,m(a[c].element,0,k),c=b,f.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,
a,a[c],c)},0)}),m(f,1,k,w,!0)):(v.style.opacity="1",u=!0,m(a[c].element,0,k,function(){f.loaded?l?(l(),l=null):(c=b,f.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,a,a[c],c)},0)}),m(f,1,k,w,!0)):(u=!1,l&&(l(),l=null),f.showOnLoaded=!0)})))}n&&(console.log("Race condition in CurrLoaded (EasySlideshowJS)! We should recover after a few slides."),clearTimeout(n));v.style.opacity="0";for(var p=0;p<d.children.length;p++){var g=d.children[p];g!=a[c].element&&g!=v&&g.parentNode.removeChild(g)}var b=
c==a.length-1?0:c+1;console.log("Going to load:");console.log(a[b]);var f=document.createElement("img");if(a[b].imgLink){var h=document.createElement("a");h.href=a[b].imgLink;h.appendChild(f)}f.loaded=!1;f.src=a[b].imgSrc;f.style.opacity="0";f.style.position="absolute";f.style.zIndex="0";f.className=x;f.setAttribute("resizeToParent","yes");a[b].imgLink?(d.appendChild(h),a[b].element=h):(d.appendChild(f),a[b].element=f);window.DoEasyResizeToParent();f.onload=function(){f.loaded=!0;f.showOnLoaded&&
(u=!0,m(a[c].element,0,k),c=b,f.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,a,a[c],c)},0)}),m(f,1,k,w,!0))};d.ShowNextImg=e;if(l&&(l(),l=null,t))return;A.forEach(function(b){setTimeout(function(){b(d,a,a[c],c)},0)});t&&(n=setTimeout(function(){n=null;e()},a[c].duration?a[c].duration:C));u=!1;l&&(l(),l=null)}if(!d)return console.error("You have not specified the div that will contain the slideshow."),null;if(!a||!Array.isArray(a))return console.error("You have not specified an array of image objects."),
null;if(!C)return console.error("You have not specified the default duration of each slide."),null;for(var z;z<a.length;z++)if(!a[z].imgSrc&&String.isString(a[z].imgSrc))return console.error("Image object at index "+z+" does not have an `imgSrc` property. Incorrect object:"),console.error(a[z]),null;if("div"!=d.tagName.toLowerCase())return console.error("The specified element is not a div."),null;if(0==a.length)return console.error("You have not specified any images for the slideshow."),console.error(a),
null;window.DoEasyResizeToParent||console.warn("EasyResizeToParent.js needs to be loaded in order for the slideshow to work properly. (https://github.com/MDTech-us-MAN/EasyResizeToParent)");window.Velocity||window.TweenLite||window.TweenMax||window.jQuery||console.warn("In order for animations to work, please load either Velocity.js (recommended) (https://github.com/julianshapiro/velocity), GASP.js (https://greensock.com/gsap), or jQuery (with animations).");k||(k=500);x||(x="");var c=0,n=null,u=
!1,l=null,v=document.createElement("img");v.src=window.EasySlideshowLoadingGIF||"EasySlideshowJSLoading.gif";v.style.position="absolute";v.className=x;var t=!0;d.ShowNextImg=null;var A=[],r=[],q=[];d.appendChild(v);console.log("Going to load:");console.log(a[0]);var h=document.createElement("img");if(a[0].imgLink){var B=document.createElement("a");B.href=a[0].imgLink;B.appendChild(h)}h.src=a[0].imgSrc;h.style.opacity="0";h.style.position="absolute";h.style.zIndex="0";h.className=x;h.setAttribute("resizeToParent",
"yes");a[0].imgLink?(d.appendChild(B),a[0].element=B):(d.appendChild(h),a[0].element=h);window.DoEasyResizeToParent();h.onload=function(){h.style.zIndex="1";r.forEach(function(e){setTimeout(function(){e(d,a,a[c],c)},0)});m(h,1,k,w,!0)};d.isPlaying=function(){return t};d.playSlideShow=function(){if(!t){var a=function(){t=!0;d.ShowNextImg()};u?l=a:a()}};d.pauseSlideShow=function(){if(t){var a=function(){t=!1;n&&(clearTimeout(n),n=null)};n&&(clearTimeout(n),n=null);u?l=a:a()}};d.currentImage=function(){return a[c]};
d.currentImageIndex=function(){return c};d.allLoadedImages=function(){return a};d.jumpToIndex=function(e){function h(){n&&(clearTimeout(n),n=null);var g=e;console.log("Going to load:");console.log(a[g]);var b=document.createElement("img");if(a[g].imgLink){var f=document.createElement("a");f.href=a[g].imgLink;f.appendChild(b)}b.loaded=!1;b.src=a[g].imgSrc;b.style.opacity="0";b.style.position="absolute";b.style.zIndex="0";b.className=x;b.setAttribute("resizeToParent","yes");a[g].imgLink?(d.appendChild(f),
a[g].element=f):(d.appendChild(b),a[g].element=b);b.onload=function(){b.loaded=!0;b.showOnLoaded&&(m(a[c].element,0,k),c=g,b.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,a,a[c],c)},0)}),m(b,1,k,w,!0))};setTimeout(function(){b.loaded?(m(a[c].element,0,k),c=g,b.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,a,a[c],c)},0)}),m(b,1,k,w,!0)):(v.style.opacity="1",m(a[c].element,0,k,function(){b.loaded?(c=g,b.style.zIndex="1",r.forEach(function(b){setTimeout(function(){b(d,
a,a[c],c)},0)}),m(b,1,k,w,!0)):b.showOnLoaded=!0}))},500)}e=parseInt(e,10);e==Number.NaN?console.error("You have not specified a valid integer index to jump to."):e>a.length-1?console.error("Cannot jump to the requested slideshow index since it is greater than the maximum possible index, "+(a.length-1)+"."):e==c?console.log("Ignored an attempt to jump to the same image as we are on now."):u?l=h:h()};d.addSlideChangeStartListener=function(a){y(r,a);r.push(a)};d.removeSlideChangeStartListener=function(a){y(r,
a)};d.addSlideChangeEndListener=function(e,h){y(A,e);A.push(e);h&&setTimeout(function(){e(d,a,a[c],c)},0)};d.removeSlideChangeEndListener=function(a){y(A,a)};d.addTransitionProgressChangeListener=function(a){y(q,a);q.push(a)};d.removeTransitionProgressChangeListener=function(a){y(q,a)};return d};
